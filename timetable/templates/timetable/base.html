<!DOCTYPE html>
<html>
{% load staticfiles %}
  <head>
    <meta charset="utf-8">
    <title>MJUTT - Time to MJU</title>
    <link rel="stylesheet" type="text/css" href="{% static 'timetable/semantic/semantic.css'%}">
    <link rel="stylesheet" type="text/css" href="{% static 'timetable/css/style.css' %}">
    <link rel="stylesheet" type="" href="{% static 'timetable/css/style.css' %}">
    <!-- use semantic.min.css <- deploy -->
    <link rel="stylesheet" href="{% static 'timetable/js/core.js' %}">
    <script
      src="https://code.jquery.com/jquery-3.1.1.min.js"
      integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
      crossorigin="anonymous"></script>
    <script src="{% static 'timetable/semantic/semantic.js'%}"></script>

  </head>
  <body>
    <div class="container">
      {% block content %}
      {% endblock %}
    </div>

    <script>
      $('.ui.dropdown').dropdown();
      $('.ui.checkbox').checkbox();
      $('.tabular.menu .item').tab();
    </script>

    <script>
    $('.table-row').hover(function(){
      $(this).addClass("hover");
    }, function(){
      $(this).removeClass("hover");
    });

    $('.table-row').click(function(event){
      $('.table-row').not(this).removeClass('clicked');
      $(this).toggleClass("clicked");
    });

    // Ajax
    $('#submit').click(function(e){
      e.preventDefault();
      // Collect checkbox value
      var mycheckboxes = new Array();
      $("input:checked").each(function(){
        mycheckboxes.push($(this).val());
      });

      $.ajax({
        type:'POST',
        url:'/',
        dataType: "json",
        data:{
          csrfmiddlewaretoken : '{{csrf_token}}',
          dept:$('#id_dropdown').val(),
          grade:mycheckboxes,
          classname:$('#classname').val(),
        },
        success: function(data){
          console.log("SUCCESS");
          console.log(data);
          rowdata = $.parseJSON(data);
          console.log(rowdata);
          $.each(rowdata, function(i, val){
            $('#table-body').empty().append(
              $('<tr class="table-row">\
              <td>'+rowdata[]+'</td>\
              <td>'+rowdata[]+'</td>\
              <td>'+rowdata[]+'</td>\
              <td>'+rowdata[]+'</td>\
              <td>'+rowdata[]+'</td>\
              <td>'+rowdata[]+'</td>\
              <td>'+rowdata[]+'</td>\
              <td>'+rowdata[]+'</td>\
              <td>'+rowdata[]+'</td>\
              </tr>')
            )
            // <tr class="table-row">
            //   <td>{{item.grade}}</td>
            //   <td>{{item.classname}}</td>
            //   <td>{{item.get_deptname}}</td>
            //   <td>{{item.credit}}</td>
            //   <td>{{item.timeperweek}}</td>
            //   <td>{{item.prof}}</td>
            //   <td>{{item.classcode}}</td>
            //   <td>{{item.limitstud}}</td>
            //   <td>{{item.time}}</td>
            //   {% if item.note %}
            //   <td>{{item.note}}</td>
            //   {% else %}
            //   <td> </td>
            //   {% endif %}
            // </tr>
          });
        },
        beforeSend:function(){
          $('#search-form').addClass("loading")
        },
        complete:function(){
          $('#search-form').removeClass("loading")
        },
        failure: function(data){
          console.log("FAIL");
          console.log(data);
        }
      });
    });

    // $('#add-item').click(function(){
    //   $.ajax({
    //     data: $()
    //   });
    // });


    </script>
    {% block javascript %}{% endblock %}

  </body>
</html>
